package me.spleef.com.Events;

import me.spleef.com.Manager;
import me.spleef.com.main;

import org.bukkit.Material;
import org.bukkit.Sound;
import org.bukkit.block.Block;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.block.Action;
import org.bukkit.event.player.PlayerInteractEvent;

import de.slikey.effectlib.effect.LineEffect;
import de.slikey.effectlib.util.ParticleEffect;

public class OnLazer implements Listener{

	
	
	@SuppressWarnings("deprecation")
	@EventHandler
	public void onLazer(PlayerInteractEvent e){
		Player p = e.getPlayer();
		if(e.getAction() == Action.LEFT_CLICK_AIR || e.getAction() == Action.RIGHT_CLICK_AIR || e.getAction() == Action.LEFT_CLICK_BLOCK || e.getAction() == Action.RIGHT_CLICK_BLOCK){
			Block b = p.getTargetBlock(null, 10).getLocation().getBlock();
			if(Manager.ingame.contains(p.getName())){
				if(p.getItemInHand().getType() == Material.BLAZE_ROD){
					   if(b.getTypeId() == 80){
				        
						   
						   if(Manager.number.get(p.getName()) >= 1){
						
							   
						LineEffect eff = new LineEffect    (main.effectManager);
				        eff.setLocation(p.getLocation().add(0, 1.8, 0));
				        eff.iterations = 20;
						  eff.setTarget(b.getLocation().add(0.5, 1, 0.5));
				        if(Manager.stats.contains("Stats.lazer."+p.getName())){
				        if(Manager.stats.getString("Stats.lazer."+ p.getName()).equalsIgnoreCase("White")){
				        eff.particle = ParticleEffect.SPELL;
				        eff.start();
				        }else  if(Manager.stats.getString("Stats.lazer."+ p.getName()).equalsIgnoreCase("Red")){
				        	 eff.particle = ParticleEffect.RED_DUST;
				        	 eff.start();
				        }else  if(Manager.stats.getString("Stats.lazer."+ p.getName()).equalsIgnoreCase("Green")){
				        	 eff.particle = ParticleEffect.HAPPY_VILLAGER;
				        	 eff.start();
				        }else  if(Manager.stats.getString("Stats.lazer."+ p.getName()).equalsIgnoreCase("Purple")  ){
				        	 eff.particle = ParticleEffect.WITCH_MAGIC;
				        	 eff.start();
				        }
				        }else{
				        	Manager.setWhite(p);
				        }
				    
				    
				 p.playSound(p.getLocation(), Sound.FIZZ, 0.5F, 10);
				    	
				    	 p.getTargetBlock(null, 20).getLocation().getBlock().setType(Material.AIR);
						    Manager.block.put(b.getLocation(), p.getName());
						    Manager.number.put(p.getName(), Manager.number.get(p.getName())-1);
						    p.setLevel(Manager.number.get(p.getName()));
						   }else{
							   p.playSound(p.getLocation(), Sound.NOTE_BASS_GUITAR, 0.5F, 10);
						   }
					
				    }
				
				
			}
			
		}
		
		
	}
	
	
	}
}
